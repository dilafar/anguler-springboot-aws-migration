{
  "SchemaVersion": 2,
  "CreatedAt": "2025-01-30T08:53:47.177679802Z",
  "ArtifactName": "522814728991.dkr.ecr.us-east-1.amazonaws.com/aws-fullstack-argocd:backend-v0.0.53-64",
  "ArtifactType": "container_image",
  "Metadata": {
    "OS": {
      "Family": "alpine",
      "Name": "3.20.5"
    },
    "ImageID": "sha256:92cf53880df222f71090a5f42916095c87ff8821c1ccb81bb0590534ba50f8d6",
    "DiffIDs": [
      "sha256:ce5a8cde9eeef09160653b9c3d14f0c1c0e2900033476a5f2a9fc950161c0eb2",
      "sha256:319681b9d2f9217e50cee83cdd9ffc7a18e93b83401ba92711538c9d316951d9",
      "sha256:b1302f229e51604722c38448ce865481ae59ba073a7a99fb5fb4bee57612ecd7",
      "sha256:9d38ec6f21f6ffaad8c5cb4a5b20e8759d7ebd8d2ea1c89badd531b8a0c2fc3c"
    ],
    "RepoTags": [
      "522814728991.dkr.ecr.us-east-1.amazonaws.com/aws-fullstack-argocd:backend-v0.0.53-64"
    ],
    "RepoDigests": [
      "522814728991.dkr.ecr.us-east-1.amazonaws.com/aws-fullstack-argocd@sha256:8b8658376bf5a6daab3558b43b31999b61d678ab4789086adf0d540c927b9e11"
    ],
    "ImageConfig": {
      "architecture": "amd64",
      "container": "b9f4eba9dfa748c9a63e23780ab0f329dac5cce08b4f782fcddb7dfb6fc8f3a3",
      "created": "2025-01-30T08:52:59.563659394Z",
      "docker_version": "24.0.7",
      "history": [
        {
          "created": "2025-01-08T12:08:14Z",
          "created_by": "ADD alpine-minirootfs-3.20.5-x86_64.tar.gz / # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-01-08T12:08:14Z",
          "created_by": "CMD [\"/bin/sh\"]",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-01-23T01:09:23Z",
          "created_by": "ARG version=17.0.14.7.1",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-01-23T01:09:23Z",
          "created_by": "RUN |1 version=17.0.14.7.1 /bin/sh -c wget -O /THIRD-PARTY-LICENSES-20200824.tar.gz https://corretto.aws/downloads/resources/licenses/alpine/THIRD-PARTY-LICENSES-20200824.tar.gz \u0026\u0026     echo \"82f3e50e71b2aee21321b2b33de372feed5befad6ef2196ddec92311bc09becb  /THIRD-PARTY-LICENSES-20200824.tar.gz\" | sha256sum -c - \u0026\u0026     tar x -ovzf THIRD-PARTY-LICENSES-20200824.tar.gz \u0026\u0026     rm -rf THIRD-PARTY-LICENSES-20200824.tar.gz \u0026\u0026     wget -O /etc/apk/keys/amazoncorretto.rsa.pub https://apk.corretto.aws/amazoncorretto.rsa.pub \u0026\u0026     SHA_SUM=\"6cfdf08be09f32ca298e2d5bd4a359ee2b275765c09b56d514624bf831eafb91\" \u0026\u0026     echo \"${SHA_SUM}  /etc/apk/keys/amazoncorretto.rsa.pub\" | sha256sum -c - \u0026\u0026     echo \"https://apk.corretto.aws\" \u003e\u003e /etc/apk/repositories \u0026\u0026     apk add --no-cache amazon-corretto-17=$version-r0 \u0026\u0026     rm -rf /usr/lib/jvm/java-17-amazon-corretto/lib/src.zip # buildkit",
          "comment": "buildkit.dockerfile.v0"
        },
        {
          "created": "2025-01-23T01:09:23Z",
          "created_by": "ENV LANG=C.UTF-8",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-01-23T01:09:23Z",
          "created_by": "ENV JAVA_HOME=/usr/lib/jvm/default-jvm",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-01-23T01:09:23Z",
          "created_by": "ENV PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/jvm/default-jvm/bin",
          "comment": "buildkit.dockerfile.v0",
          "empty_layer": true
        },
        {
          "created": "2025-01-30T08:52:57Z",
          "created_by": "/bin/sh -c addgroup -S pipeline \u0026\u0026 adduser -S k8-user -G pipeline"
        },
        {
          "created": "2025-01-30T08:52:59Z",
          "created_by": "/bin/sh -c #(nop) COPY file:9834f27fe9a7cf0c3966333bad73f3f632a9362d15025cf7fc24fac91d05dd1a in /home/k8-user/app.jar "
        },
        {
          "created": "2025-01-30T08:52:59Z",
          "created_by": "/bin/sh -c #(nop)  USER k8-user",
          "empty_layer": true
        },
        {
          "created": "2025-01-30T08:52:59Z",
          "created_by": "/bin/sh -c #(nop)  EXPOSE 8080",
          "empty_layer": true
        },
        {
          "created": "2025-01-30T08:52:59Z",
          "created_by": "/bin/sh -c #(nop)  ENTRYPOINT [\"java\" \"-jar\" \"/home/k8-user/app.jar\"]",
          "empty_layer": true
        }
      ],
      "os": "linux",
      "rootfs": {
        "type": "layers",
        "diff_ids": [
          "sha256:ce5a8cde9eeef09160653b9c3d14f0c1c0e2900033476a5f2a9fc950161c0eb2",
          "sha256:319681b9d2f9217e50cee83cdd9ffc7a18e93b83401ba92711538c9d316951d9",
          "sha256:b1302f229e51604722c38448ce865481ae59ba073a7a99fb5fb4bee57612ecd7",
          "sha256:9d38ec6f21f6ffaad8c5cb4a5b20e8759d7ebd8d2ea1c89badd531b8a0c2fc3c"
        ]
      },
      "config": {
        "Entrypoint": [
          "java",
          "-jar",
          "/home/k8-user/app.jar"
        ],
        "Env": [
          "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/jvm/default-jvm/bin",
          "LANG=C.UTF-8",
          "JAVA_HOME=/usr/lib/jvm/default-jvm"
        ],
        "Image": "sha256:1594cbfdc18d05f662d59b69b3e12d0410c58b987fabe70bb0d36c10e2ec6454",
        "User": "k8-user",
        "WorkingDir": "/"
      }
    }
  },
  "Results": [
    {
      "Target": "522814728991.dkr.ecr.us-east-1.amazonaws.com/aws-fullstack-argocd:backend-v0.0.53-64 (alpine 3.20.5)",
      "Class": "os-pkgs",
      "Type": "alpine"
    },
    {
      "Target": "Java",
      "Class": "lang-pkgs",
      "Type": "jar",
      "Vulnerabilities": [
        {
          "VulnerabilityID": "CVE-2024-50379",
          "PkgName": "org.apache.tomcat.embed:tomcat-embed-core",
          "PkgPath": "home/k8-user/app.jar/BOOT-INF/lib/tomcat-embed-core-10.1.31.jar",
          "PkgIdentifier": {
            "PURL": "pkg:maven/org.apache.tomcat.embed/tomcat-embed-core@10.1.31",
            "UID": "7750282317461138"
          },
          "InstalledVersion": "10.1.31",
          "FixedVersion": "11.0.2, 10.1.34, 9.0.98",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:9d38ec6f21f6ffaad8c5cb4a5b20e8759d7ebd8d2ea1c89badd531b8a0c2fc3c"
          },
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-50379",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory Maven",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Amaven"
          },
          "Title": "tomcat: RCE due to TOCTOU issue in JSP compilation",
          "Description": "Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability during JSP compilation in Apache Tomcat permits an RCE on case insensitive file systems when the default servlet is enabled for write (non-default configuration).\n\nThis issue affects Apache Tomcat: from 11.0.0-M1 through 11.0.1, from 10.1.0-M1 through 10.1.33, from 9.0.0.M1 through 9.0.97.\n\nUsers are recommended to upgrade to version 11.0.2, 10.1.34 or 9.0.98, which fixes the issue.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-367"
          ],
          "VendorSeverity": {
            "amazon": 3,
            "bitnami": 4,
            "ghsa": 3,
            "photon": 4,
            "redhat": 2
          },
          "CVSS": {
            "bitnami": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "V3Score": 9.8
            },
            "ghsa": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "V3Score": 9.8
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "V3Score": 8.1
            }
          },
          "References": [
            "http://www.openwall.com/lists/oss-security/2024/12/17/4",
            "http://www.openwall.com/lists/oss-security/2024/12/18/2",
            "https://access.redhat.com/security/cve/CVE-2024-50379",
            "https://github.com/apache/tomcat",
            "https://github.com/apache/tomcat/commit/05ddeeaa54df1e2dc427d0164bedd6b79f78d81f",
            "https://github.com/apache/tomcat/commit/43b507ebac9d268b1ea3d908e296cc6e46795c00",
            "https://github.com/apache/tomcat/commit/631500b0c9b2a2a2abb707e3de2e10a5936e5d41",
            "https://github.com/apache/tomcat/commit/684247ae85fa633b9197b32391de59fc54703842",
            "https://github.com/apache/tomcat/commit/8554f6b1722b33a2ce8b0a3fad37825f3a75f2d2",
            "https://github.com/apache/tomcat/commit/cc7a98b57c6dc1df21979fcff94a36e068f4456c",
            "https://lists.apache.org/thread/y6lj6q1xnp822g6ro70tn19sgtjmr80r",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-50379",
            "https://security.netapp.com/advisory/ntap-20250103-0003",
            "https://security.netapp.com/advisory/ntap-20250103-0003/",
            "https://tomcat.apache.org/security-10.html#Fixed_in_Apache_Tomcat_10.1.34",
            "https://tomcat.apache.org/security-11.html#Fixed_in_Apache_Tomcat_11.0.2",
            "https://tomcat.apache.org/security-9.html#Fixed_in_Apache_Tomcat_9.0.98",
            "https://www.cve.org/CVERecord?id=CVE-2024-50379"
          ],
          "PublishedDate": "2024-12-17T13:15:18.81Z",
          "LastModifiedDate": "2025-01-03T12:15:26.403Z"
        },
        {
          "VulnerabilityID": "CVE-2024-56337",
          "PkgName": "org.apache.tomcat.embed:tomcat-embed-core",
          "PkgPath": "home/k8-user/app.jar/BOOT-INF/lib/tomcat-embed-core-10.1.31.jar",
          "PkgIdentifier": {
            "PURL": "pkg:maven/org.apache.tomcat.embed/tomcat-embed-core@10.1.31",
            "UID": "7750282317461138"
          },
          "InstalledVersion": "10.1.31",
          "FixedVersion": "11.0.2, 10.1.34, 9.0.98",
          "Status": "fixed",
          "Layer": {
            "DiffID": "sha256:9d38ec6f21f6ffaad8c5cb4a5b20e8759d7ebd8d2ea1c89badd531b8a0c2fc3c"
          },
          "SeveritySource": "ghsa",
          "PrimaryURL": "https://avd.aquasec.com/nvd/cve-2024-56337",
          "DataSource": {
            "ID": "ghsa",
            "Name": "GitHub Security Advisory Maven",
            "URL": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Amaven"
          },
          "Title": "tomcat: Incomplete fix for CVE-2024-50379 - RCE due to TOCTOU issue in JSP compilation",
          "Description": "Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability in Apache Tomcat.\n\nThis issue affects Apache Tomcat: from 11.0.0-M1 through 11.0.1, from 10.1.0-M1 through 10.1.33, from 9.0.0.M1 through 9.0.97.\n\nThe mitigation for CVE-2024-50379 was incomplete.\n\nUsers running Tomcat on a case insensitive file system with the default servlet write enabled (readonly initialisation \nparameter set to the non-default value of false) may need additional configuration to fully mitigate CVE-2024-50379 depending on which version of Java they are using with Tomcat:\n- running on Java 8 or Java 11: the system property sun.io.useCanonCaches must be explicitly set to false (it defaults to true)\n- running on Java 17: the system property sun.io.useCanonCaches, if set, must be set to false (it defaults to false)\n- running on Java 21 onwards: no further configuration is required (the system property and the problematic cache have been removed)\n\nTomcat 11.0.3, 10.1.35 and 9.0.99 onwards will include checks that sun.io.useCanonCaches is set appropriately before allowing the default servlet to be write enabled on a case insensitive file system. Tomcat will also set sun.io.useCanonCaches to false by default where it can.",
          "Severity": "HIGH",
          "CweIDs": [
            "CWE-367"
          ],
          "VendorSeverity": {
            "amazon": 3,
            "bitnami": 4,
            "ghsa": 3,
            "photon": 4,
            "redhat": 2
          },
          "CVSS": {
            "bitnami": {
              "V3Vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "V3Score": 9.8
            },
            "redhat": {
              "V3Vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "V3Score": 8.1
            }
          },
          "References": [
            "https://access.redhat.com/security/cve/CVE-2024-56337",
            "https://github.com/apache/tomcat",
            "https://lists.apache.org/thread/b2b9qrgjrz1kvo4ym8y2wkfdvwoq6qbp",
            "https://nvd.nist.gov/vuln/detail/CVE-2024-56337",
            "https://security.netapp.com/advisory/ntap-20250103-0002",
            "https://security.netapp.com/advisory/ntap-20250103-0002/",
            "https://tomcat.apache.org/security-10.html#Fixed_in_Apache_Tomcat_10.1.34",
            "https://tomcat.apache.org/security-11.html#Fixed_in_Apache_Tomcat_11.0.2",
            "https://tomcat.apache.org/security-9.html#Fixed_in_Apache_Tomcat_9.0.98",
            "https://www.cve.org/CVERecord?id=CVE-2024-50379",
            "https://www.cve.org/CVERecord?id=CVE-2024-56337"
          ],
          "PublishedDate": "2024-12-20T16:15:24.26Z",
          "LastModifiedDate": "2025-01-03T12:15:26.787Z"
        }
      ]
    }
  ]
}
